(function(){angular.module("enforumApp",["ngRoute","ngSanitize","ui.bootstrap"]);function o(o){o.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/forum/:forumid",{templateUrl:"/postList/postList.view.html",css:"/postList/postList.style.css",controller:"listCtrl",controllerAs:"vm"}).when("/thread/:postid",{templateUrl:"/postRetrieve/postRetrieve.view.html",controller:"retrieveCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}angular.module("enforumApp").config(["$routeProvider",o])})();(function(){angular.module("enforumApp").controller("homeCtrl",o);o.$inject=["$uibModal","enForumData","$route"];function o(o,e,t){var n=this;n.pageHeader={title:"Enforum",strapline:"The best forum on Earth!"};e.retrieveForumList().success(function(o){n.data={forums:o}}).error(function(o){console.log(o)});n.popupSettings=function(){var e=o.open({templateUrl:"/settingsModal/settingsModal.view.html",controller:"settingsModalCtrl as vm",windowClass:"settings-modal"});e.result.then(function(o){console.log("POPUP SETTING RESULT",o.settings);n.data.forums.push(o)})};n.editPopupSettings=function(e){console.log("EDIT POPUP SETTINGS START",e);var t=o.open({templateUrl:"/editForumModal/editForumSettingsModal.view.html",controller:"editForumSettingsModalCtrl as vm",windowClass:"settings-modal",resolve:{editId:function(){return e}}});t.result.then(function(o){console.log("POPUP SETTING RESULT",o.settings);n.data.forums.push(o)})};n.deleteForum=function(o){console.log("DELETE FORUM",o);n.doDeleteForum(o)};n.doDeleteForum=function(o){console.log("DO DELETE FORUM",o);e.deleteForum({id:o}).success(function(o){t.reload()}).error(function(o){console.log(o)})}}})();(function(){angular.module("enforumApp").controller("listCtrl",o);o.$inject=["$routeParams","$uibModal","enForumData","$scope","$route"];function o(o,e,t,n,r){var l=this;console.log("LIST CONTROL FUNCTION START");l.forumid=o.forumid;console.log("VM FORUM ID",l.forumid);t.postListById(l.forumid).success(function(o){console.log("LIST CONTROL FUNCTION SUCCESS",o[0].settings);l.data={id:l.forumid,settings:o[0].settings,posts:o[0].posts};console.log("FINAL DATA OUTPUT",l.data.settings)}).error(function(o){console.log("LIST CONTROL FUNCTION ERROR");console.log(o)});console.log("AFTER DB CALL LOG");l.pageHeader={title:"Enforum",strapline:"The best forum on Earth!"};l.deleteThread=function(o){console.log("DELETE THREAD",o);l.doDeleteThread(o)};l.doDeleteThread=function(o){console.log("DO DELETE THREAD",o);t.deleteThread({id:o}).success(function(o){r.reload()}).error(function(o){console.log(o)})};l.popupSettings=function(){console.log("POPUP SETTINGS CALLED");var o=e.open({templateUrl:"/postModal/postModal.view.html",controller:"postModalCtrl as vm",windowClass:"settings-modal",resolve:{editId:function(){return l.forumid}}});o.result.then(function(o){console.log("POSTLIST POPUP SETTING RESULT",o.posts);l.data.posts.push(o.posts)})};l.editPopupSettings=function(o){console.log("EDIT POPUP UPDATE THREAD START",o);var t=e.open({templateUrl:"/editThreadModal/editThreadSettingsModal.view.html",controller:"editThreadModalCtrl as vm",windowClass:"settings-modal",resolve:{editId:function(){return o}}});t.result.then(function(o){console.log("POPUP UPDATE THREAD RESULT",o.settings);l.data.forums.push(o)})}}})();(function(){angular.module("enforumApp").controller("retrieveCtrl",o);o.$inject=["$routeParams","enForumData","$scope"];function o(o,e,t){console.log("RETRIEVE THREAD POSTS/REPLIES FUNCTION START");var n=this;n.threadid=o.postid;console.log("VM THREAD ID",n.threadid);n.pageHeader={title:"Enforum",strapline:"This is the post data."};e.retrievePostsById(n.threadid).success(function(o){console.log("RETRIEVE THREAD FUNCTION SUCCESS",o);console.log("SLICE",o[0].posts[0].title);n.data={id:o[0].posts[0]._id,title:o[0].posts[0].title,replies:o[0].posts[0].replies}}).error(function(o){console.log("ERROR RETRIEVE POSTS FUNCTION")})}})();(function(){angular.module("enforumApp").controller("postModalCtrl",o);o.$inject=["$uibModalInstance","enForumData","editId"];function o(o,e,t){var n=this;n.onSubmit=function(){console.log("POST FORM DATA SUBMISSION");n.doCreatePost(n.formData)};n.doCreatePost=function(o){console.log("DO CREATE POST");var r=new Date;var l=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()+"-"+r.getHours()+"-"+r.getMinutes();e.postCreate({id:t,title:o.title,content:o.contents,beginPost:"2018-04-07",sendPost:l}).success(function(o){console.log("SUCCESS DO CREATE POST",o);n.modal.close(o)}).error(function(o){n.formError="Your post has not been saved.  Please try again.";console.log("ERROR DO CREATE POST",o)})};n.modal={close:function(e){o.close(e)},cancel:function(){o.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").controller("settingsModalCtrl",o);o.$inject=["$uibModalInstance","enForumData"];function o(o,e){var t=this;t.onSubmit=function(){console.log("SETTINGS MODAL CONTROL",t.formData);t.formError="";if(!t.formData.name){t.formError="Please make sure all fields are filled out.";return false}else{t.doCreateForum(t.formData)}};t.doCreateForum=function(o){e.createForum({name:o.name,description:o.description,gradingMethod:o.gradingMethod,points:o.gradeTotal,peereval:o.peerEvalToggle,reflection:o.reflectionToggle}).success(function(o){console.log("DO CREATE FORUM",o);t.modal.close(o)}).error(function(o){t.formError="Your forum has not been saved.  Please try again."})};t.modal={close:function(e){o.close(e)},cancel:function(){o.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").controller("editForumSettingsModalCtrl",o);o.$inject=["$route","$uibModalInstance","enForumData","editId"];function o(o,e,t,n){var r=this;console.log("EDIT SETTINGS CTRL",n);t.postListById(n).success(function(o){console.log("EDIT SETTINGS MODAL VIEW SUCCESS",o[0]);viewData=o[0].settings;r.formData=viewData;console.log("DATA",r.data)}).error(function(o){console.log("EDIT SETTINGS MODAL VIEW ERROR",o);console.log(o)});r.onSubmit=function(){console.log("SETTINGS MODAL CONTROL",r.formData);r.formError="";if(!r.formData.name){r.formError="Please make sure all fields are filled out.";return false}else{r.doUpdateForum(r.formData)}};r.doUpdateForum=function(e){console.log("DO UPDATE SETTINGS");t.updateForum({forumid:n,name:e.name,description:e.description,gradingMethod:e.gradingMethod,points:e.gradeTotal,peereval:e.peerEvalToggle,reflection:e.reflectionToggle}).success(function(e){console.log("DO UPDATE SETTINGS FORUM",e);r.modal.close(e);o.reload()}).error(function(o){r.formError="Your forum has not been saved.  Please try again."})};r.modal={close:function(o){e.close(o)},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").controller("editThreadModalCtrl",o);o.$inject=["$route","$uibModalInstance","enForumData","editId"];function o(o,t,n,r){console.log("EDIT THREAD MODAL START",r);var l=this;n.threadContentsById(r).success(function(o){console.log("EDIT THREAD CONTENTS MODAL VIEW SUCCESS",o[0].posts[0]);l.data={post:o[0].posts[0]}}).error(function(o){console.log("EDIT THREAD CONTENTS MODAL VIEW ERROR");console.log(e)});l.onSubmit=function(){console.log("EDIT THREAD FORM DATA SUBMISSION",l.data.post);l.doUpdateThread(l.data.post)};l.doUpdateThread=function(e){console.log("DO UPDATE THREAD",e);n.updateThread({id:r,title:e.title,content:e.content}).success(function(e){console.log("SUCCESS DO UPDATE THREAD",e);l.modal.close(e);o.reload()}).error(function(o){l.formError="Your post has not been saved.  Please try again.";console.log("ERROR DO UPDATE THREAD",o)})};l.modal={close:function(o){t.close(o)},cancel:function(){t.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").controller("reflectionSettingsModalCtrl",o);o.$inject=["$uibModalInstance"];function o(o){var e=this;e.data={title:"lol"};e.modal={close:function(e){o.close(e)},cancel:function(){o.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").directive("navigation",o);function o(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("enforumApp").service("enForumData",o);o.$inject=["$http"];function o(o){var e=function(e){return o.post("/api/forum",e)};var t=function(){return o.get("/api/forum/list")};var n=function(e){return o.post("/api/forum/delete",e)};var r=function(e){console.log("DELETE THREAD ENFORUMDATA SERVICE",e);return o.post("/api/forum/thread/delete",e)};var l=function(e){console.log("CREATE POST ENFORUMDATA SERVICE",e);return o.post("/api/post/create",e)};var s=function(e){console.log("POST LIST BY ID",e);return o.get("/api/forums/"+e)};var a=function(e){console.log("THREAD LIST BY ID",e);return o.get("/api/forum/thread/"+e)};var i=function(e){console.log("ENFORUM DATA SERVICE UPDATE DATA",e);return o.put("/api/forum/update/"+e.forumid,e)};var u=function(e){console.log("ENFORUM DATA SERVICE UPDATE THREAD DATA",e);return o.put("/api/forum/thread/update/"+e.id,e)};var c=function(e){console.log("POSTS AND REPLIES DATA SERVICE",e);return o.get("/api/forum/"+e+"/posts")};return{createForum:e,retrieveForumList:t,deleteForum:n,deleteThread:r,postCreate:l,postListById:s,threadContentsById:a,updateForum:i,updateThread:u,retrievePostsById:c}}})();