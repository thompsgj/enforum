(function(){angular.module("enforumApp",["ngRoute","ngSanitize","ui.bootstrap"]);function o(o){o.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/forum/:forumid",{templateUrl:"/postList/postList.view.html",css:"/postList/postList.style.css",controller:"listCtrl",controllerAs:"vm"}).when("/thread/:postid",{templateUrl:"/postRetrieve/postRetrieve.view.html",controller:"retrieveCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}angular.module("enforumApp").config(["$routeProvider",o])})();(function(){angular.module("enforumApp").controller("homeCtrl",o);o.$inject=["$uibModal","enForumData","$route"];function o(o,e,t){var n=this;n.pageHeader={title:"Enforum",strapline:"The best forum on Earth!"};e.retrieveForumList().success(function(o){n.data={forums:o}}).error(function(o){console.log(o)});n.popupSettings=function(){var e=o.open({templateUrl:"/settingsModal/settingsModal.view.html",controller:"settingsModalCtrl as vm",windowClass:"settings-modal"});e.result.then(function(o){console.log("POPUP SETTING RESULT",o.settings);n.data.forums.push(o)})};n.editPopupSettings=function(e){console.log("EDIT POPUP SETTINGS START",e);var t=o.open({templateUrl:"/editForumModal/editForumSettingsModal.view.html",controller:"editForumSettingsModalCtrl as vm",windowClass:"settings-modal",resolve:{editId:function(){return e}}});t.result.then(function(o){console.log("POPUP SETTING RESULT",o.settings);n.data.forums.push(o)})};n.deleteForum=function(o){console.log("DELETE FORUM",o);n.doDeleteForum(o)};n.doDeleteForum=function(o){console.log("DO DELETE FORUM",o);e.deleteForum({id:o}).success(function(o){t.reload()}).error(function(o){console.log(o)})}}})();(function(){angular.module("enforumApp").controller("listCtrl",o);o.$inject=["$routeParams","$uibModal","enForumData","$scope","$route"];function o(o,e,t,n,l){var r=this;console.log("LIST CONTROL FUNCTION START");r.forumid=o.forumid;console.log("VM FORUM ID",r.forumid);t.postListById(r.forumid).success(function(o){console.log("LIST CONTROL FUNCTION SUCCESS",o[0].settings);r.data={id:r.forumid,settings:o[0].settings,posts:o[0].posts};console.log("FINAL DATA OUTPUT",r.data.settings)}).error(function(o){console.log("LIST CONTROL FUNCTION ERROR");console.log(o)});console.log("AFTER DB CALL LOG");r.pageHeader={title:"Enforum",strapline:"The best forum on Earth!"};r.deleteThread=function(o){console.log("DELETE THREAD",o);r.doDeleteThread(o)};r.doDeleteThread=function(o){console.log("DO DELETE THREAD",o);t.deleteThread({id:o}).success(function(o){l.reload()}).error(function(o){console.log(o)})};r.popupSettings=function(){console.log("POPUP SETTINGS CALLED");var o=e.open({templateUrl:"/postModal/postModal.view.html",controller:"postModalCtrl as vm",windowClass:"settings-modal",resolve:{editId:function(){return r.forumid}}});o.result.then(function(o){console.log("POSTLIST POPUP SETTING RESULT",o.posts);r.data.posts.push(o.posts)})};r.editPopupSettings=function(o){console.log("EDIT POPUP UPDATE THREAD START",o);var t=e.open({templateUrl:"/editThreadModal/editThreadSettingsModal.view.html",controller:"editThreadModalCtrl as vm",windowClass:"settings-modal",resolve:{editId:function(){return o}}});t.result.then(function(o){console.log("POPUP UPDATE THREAD RESULT",o.settings);r.data.forums.push(o)})}}})();(function(){angular.module("enforumApp").controller("retrieveCtrl",o);o.$inject=["$uibModal","$routeParams","enForumData","$scope","$route"];function o(o,e,t,n,l){console.log("RETRIEVE THREAD POSTS/REPLIES FUNCTION START");var r=this;r.threadid=e.postid;console.log("VM THREAD ID",r.threadid);r.pageHeader={title:"Enforum",strapline:"This is the post data."};t.retrievePostsById(r.threadid).success(function(o){console.log("RETRIEVE THREAD FUNCTION SUCCESS",o);console.log("SLICE",o[0].posts[0].title);r.data={id:o[0].posts[0]._id,title:o[0].posts[0].title,grade:o[0].posts[0].grade,replies:o[0].posts[0].replies}}).error(function(o){console.log("ERROR RETRIEVE POSTS FUNCTION")});r.addReplyModal=function(){console.log("CREATE REPLY SETTINGS START",r.threadid);var e=o.open({templateUrl:"/replyModal/replyModal.view.html",controller:"replyModalCtrl as vm",windowClass:"settings-modal",resolve:{threadId:function(){return r.threadid}}});e.result.then(function(o){console.log("POPUP SETTING RESULT",o);l.reload()})};r.deleteReply=function(o){console.log("DELETE REPLY",o);r.doDeleteReply(o)};r.doDeleteReply=function(o){console.log("DO DELETE REPLY",o);t.deleteReply({id:o}).success(function(o){console.log("REPLY DELETE SUCCESS");l.reload()}).error(function(o){console.log(o)})};r.editReplyModal=function(e){console.log("EDIT REPLY SETTINGS START",e);var t=o.open({templateUrl:"/editReplyModal/editReplyModal.view.html",controller:"editReplyModalCtrl as vm",windowClass:"settings-modal",resolve:{replyId:function(){return e}}});console.log("EDIT REPLY SETTINGS MIDDLE");t.result.then(function(o){console.log("POPUP SETTING RESULT",o);l.reload()})};n.gradePossibilities=["",1,2,3];n.selectedGradeChange=function(o,e){console.log("TYPE",e);t.setGrade({type:e,id:o,grade:r.selectedGrade});console.log("Data "+o);console.log("The value is "+r.selectedGrade)}}})();(function(){angular.module("enforumApp").controller("postModalCtrl",o);o.$inject=["$uibModalInstance","enForumData","editId"];function o(o,e,t){var n=this;n.onSubmit=function(){console.log("POST FORM DATA SUBMISSION");n.doCreatePost(n.formData)};n.doCreatePost=function(o){console.log("DO CREATE POST");var l=new Date;var r=l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate()+"-"+l.getHours()+"-"+l.getMinutes();e.postCreate({id:t,title:o.title,content:o.contents,beginPost:"2018-04-07",sendPost:r}).success(function(o){console.log("SUCCESS DO CREATE POST",o);n.modal.close(o)}).error(function(o){n.formError="Your post has not been saved.  Please try again.";console.log("ERROR DO CREATE POST",o)})};n.modal={close:function(e){o.close(e)},cancel:function(){o.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").controller("replyModalCtrl",o);o.$inject=["$uibModalInstance","enForumData","threadId"];function o(o,e,t){var n=this;n.onSubmit=function(){console.log("POST FORM DATA SUBMISSION");n.doCreateReply(n.formData)};n.doCreateReply=function(o){console.log("DO CREATE REPLY");var l=new Date;var r=l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate()+"-"+l.getHours()+"-"+l.getMinutes();e.replyCreate({id:t,title:o.title,content:o.contents,beginReply:"2018-04-07",sendReply:r}).success(function(o){console.log("SUCCESS DO CREATE POST",o);n.modal.close(o)}).error(function(o){n.formError="Your post has not been saved.  Please try again.";console.log("ERROR DO CREATE REPLY",o)})};n.modal={close:function(e){o.close(e)},cancel:function(){o.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").controller("settingsModalCtrl",o);o.$inject=["$uibModalInstance","enForumData","$scope"];function o(o,e,t){var n=this;n.checklist=[];n.addNewChoice=function(){console.log("ADD NEW CHOICE");console.log("CHECKLIST",n.checklist);console.log("CHECKLIST NUMBER",n.checklist.length);var o=n.checklist.length+1;n.checklist.push({criteria:""})};n.removeChoice=function(){var o=n.checklist.length-1;if(o!==-1){n.checklist.pop("")}};n.onSubmit=function(){console.log("SETTINGS MODAL CONTROL",n.formData);n.formError="";if(!n.formData.name){n.formError="Please make sure all fields are filled out.";return false}else{n.doCreateForum(n.formData)}};n.doCreateForum=function(o){console.log("FORMDATA",n.formData);e.createForum({name:o.name,description:o.description,gradingMethod:o.gradingMethod,points:o.gradeTotal,peereval:o.peerEvalToggle,reflection:o.reflectionToggle,reflectionChecklist:n.checklist}).success(function(o){console.log("DO CREATE FORUM",o);n.modal.close(o)}).error(function(o){n.formError="Your forum has not been saved.  Please try again."})};n.modal={close:function(e){o.close(e)},cancel:function(){o.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").controller("editForumSettingsModalCtrl",o);o.$inject=["$route","$uibModalInstance","enForumData","editId"];function o(o,e,t,n){var l=this;l.checklist=[];l.addNewChoice=function(){console.log("ADD NEW CHOICE");console.log("CHECKLIST",l.checklist);console.log("CHECKLIST NUMBER",l.checklist.length);var o=l.checklist.length+1;l.checklist.push({criteria:""})};l.removeChoice=function(){var o=l.checklist.length-1;if(o!==-1){l.checklist.pop("")}};console.log("EDIT SETTINGS CTRL",n);t.postListById(n).success(function(o){console.log("EDIT SETTINGS MODAL VIEW SUCCESS",o[0]);viewData=o[0].settings;l.formData=viewData;console.log("DATA",l.formData)}).error(function(o){console.log("EDIT SETTINGS MODAL VIEW ERROR",o);console.log(o)});l.onSubmit=function(){console.log("SETTINGS MODAL CONTROL",l.formData);l.formError="";if(!l.formData.name){l.formError="Please make sure all fields are filled out.";return false}else{l.doUpdateForum(l.formData)}};l.doUpdateForum=function(e){console.log("DO UPDATE SETTINGS",e);t.updateForum({forumid:n,name:e.name,description:e.description,gradingMethod:e.gradingMethod,points:e.points,peereval:e.peereval,reflection:e.reflection,reflectionChecklist:e.reflectionChecklist}).success(function(e){console.log("DO UPDATE SETTINGS FORUM",e);l.modal.close(e);o.reload()}).error(function(o){l.formError="Your forum has not been saved.  Please try again."})};l.modal={close:function(o){e.close(o)},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").controller("editThreadModalCtrl",o);o.$inject=["$route","$uibModalInstance","enForumData","editId"];function o(o,t,n,l){console.log("EDIT THREAD MODAL START",l);var r=this;n.threadContentsById(l).success(function(o){console.log("EDIT THREAD CONTENTS MODAL VIEW SUCCESS",o[0].posts[0]);r.data={post:o[0].posts[0]}}).error(function(o){console.log("EDIT THREAD CONTENTS MODAL VIEW ERROR");console.log(e)});r.onSubmit=function(){console.log("EDIT THREAD FORM DATA SUBMISSION",r.data.post);r.doUpdateThread(r.data.post)};r.doUpdateThread=function(e){console.log("DO UPDATE THREAD",e);n.updateThread({id:l,title:e.title,content:e.content}).success(function(e){console.log("SUCCESS DO UPDATE THREAD",e);r.modal.close(e);o.reload()}).error(function(o){r.formError="Your post has not been saved.  Please try again.";console.log("ERROR DO UPDATE THREAD",o)})};r.modal={close:function(o){t.close(o)},cancel:function(){t.dismiss("cancel")}}}})();(function(){console.log("Instance Create");angular.module("enforumApp").controller("editReplyModalCtrl",o);console.log("Injection");o.$inject=["$route","$uibModalInstance","enForumData","replyId"];function o(o,t,n,l){console.log("EDIT REPLY MODAL START",l);var r=this;n.retrieveReply(l).success(function(o){console.log("EDIT REPLY CONTENTS MODAL VIEW SUCCESS",o[0]);r.formData={_id:o[0]._id,title:o[0].title,contents:o[0].content,beginReply:o[0].beginReply,sendReply:o[0].sendReply}}).error(function(o){console.log("EDIT REPLY CONTENTS MODAL VIEW ERROR");console.log(e)});r.onSubmit=function(o){console.log("EDIT REPLY FORM DATA SUBMISSION",r.formData);r.doUpdateReply(r.formData)};r.doUpdateReply=function(e){console.log("DO UPDATE REPLY",e);n.updateReply({id:l,title:e.title,content:e.contents}).success(function(e){console.log("SUCCESS DO UPDATE REPLY",e);r.modal.close(e);o.reload()}).error(function(o){r.formError="Your post has not been saved.  Please try again.";console.log("ERROR DO UPDATE REPLY",o)})};r.modal={close:function(o){t.close(o)},cancel:function(){t.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").controller("reflectionSettingsModalCtrl",o);o.$inject=["$uibModalInstance"];function o(o){var e=this;e.data={title:"lol"};e.modal={close:function(e){o.close(e)},cancel:function(){o.dismiss("cancel")}}}})();(function(){angular.module("enforumApp").directive("navigation",o);function o(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("enforumApp").service("enForumData",o);o.$inject=["$http"];function o(o){var e=function(e){return o.post("/api/forum",e)};var t=function(){return o.get("/api/forum/list")};var n=function(e){return o.post("/api/forum/delete",e)};var l=function(e){console.log("DELETE THREAD ENFORUMDATA SERVICE",e);return o.post("/api/forum/thread/delete",e)};var r=function(e){console.log("CREATE POST ENFORUMDATA SERVICE",e);return o.post("/api/post/create",e)};var s=function(e){console.log("POST LIST BY ID",e);return o.get("/api/forums/"+e)};var a=function(e){console.log("THREAD LIST BY ID",e);return o.get("/api/forum/thread/"+e)};var i=function(e){console.log("ENFORUM DATA SERVICE UPDATE DATA",e);return o.put("/api/forum/update/"+e.forumid,e)};var c=function(e){console.log("ENFORUM DATA SERVICE UPDATE THREAD DATA",e);return o.put("/api/forum/thread/update/"+e.id,e)};var u=function(e){console.log("POSTS AND REPLIES DATA SERVICE",e);return o.get("/api/forum/"+e+"/posts")};var d=function(e){console.log("ENFORUM DATA SERVICE REPLY CREATE",e);return o.post("/api/reply/create",e)};var E=function(e){console.log("ENFORUM DATA SERVICE DELETE REPLY",e);return o.post("/api/reply/delete",e)};var f=function(e){console.log("ENFORUM DATA SERVICE UPDATE REPLY",e.id);return o.put("/api/reply/update/"+e.id,e)};var T=function(e){console.log("ENFORUM DATA SERVICE RETRIEVE REPLY",e);return o.get("/api/reply/"+e)};var p=function(e){console.log("ENFORUM DATA SERVICE SET GRADE",e);return o.post("/api/grade",e)};return{createForum:e,retrieveForumList:t,deleteForum:n,deleteThread:l,postCreate:r,postListById:s,threadContentsById:a,updateForum:i,updateThread:c,retrievePostsById:u,replyCreate:d,deleteReply:E,updateReply:f,retrieveReply:T,setGrade:p}}})();